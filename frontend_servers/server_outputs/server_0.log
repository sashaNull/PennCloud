IP: 127.0.0.1:8000
Listening fd: 3
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Listening...
Client closed the connection.
GET / HTTP/1.1
end of parse
I am in get cookie handler from the request
Sent redirection response to /login
redirect response: HTTP/1.1 302 Found
Location: /login
Content-Length: 0
Connection: keep-alive


Sent redirection response to /login
redirect response: HTTP/1.1 302 Found
Location: /login
Content-Length: 0
Connection: keep-alive


Listening...
GET /login HTTP/1.1
end of parse
I am in get cookie handler from the request
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Login</title>
</head>

<body>

    <h2>User Login</h2>
    <form id="loginForm">
        <label for="username">Username:</label><br>
        <input type="text" id="username" name="username" required><br>
        <label for="password">Password:</label><br>
        <input type="password" id="password" name="password" required><br><br>
        <button type="submit">Login</button>
    </form>

    <p>Don't have an account? <a href="/signup">Sign up</a></p>

    <script>
        document.getElementById("loginForm").addEventListener("submit", function (event) {
            event.preventDefault();
            var formData = {
                username: document.getElementById("username").value,
                password: document.getElementById("password").value
            };
            fetch("/login", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(formData)
            })
                .then(response => {
                    if (response.ok) {
                        window.location.href = "/home"; // Redirect to the home page
                        return;
                    }
                    // Not a 2XX response, so parse the JSON and handle it
                    return response.json().then(data => {
                        if (response.status === 404 && data.error === "User does not exist") {
                            throw new Error("Username does not exist"); // This will be caught by .catch
                        }
                        else if (response.status === 401 && data.error === "Incorrect password") {
                            throw new Error("Password is incorrect"); // This will be caught by .catch
                        }
                        throw new Error("Login failed for another reason"); // General error
                    });
                })
                .catch(error => {
                    console.error("Error logging in:", error);
                    alert(error.message);
                });
        });
    </script>

</body>

</html>
Sent response successfully, bytes sent: 2368
Listening...
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
Listening...
Client closed the connection.
